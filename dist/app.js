"use strict";function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(t)}function t(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var i="function"==typeof Symbol&&"symbol"==e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)};!function(){for(var e=["DocumentType","Element","CharacterData"],t=function(){null!=this.parentNode&&this.parentNode.removeChild(this)},i=0;i<e.length;i++){var r=e[i];window[r]&&!window[r].prototype.remove&&(window[r].prototype.remove=t)}}(),function(e){function t(){}function r(e){if("object"!==i(this))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],u(e,this)}function n(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void r._immediateFn((function(){var i=1===e._state?t.onFulfilled:t.onRejected;if(null!==i){var r;try{r=i(e._value)}catch(e){return void s(t.promise,e)}o(t.promise,r)}else(1===e._state?o:s)(t.promise,e._value)})))}function o(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===(void 0===t?"undefined":i(t))||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void a(e);if("function"==typeof n)return void u(function(e,t){return function(){e.apply(t,arguments)}}(n,t),e)}e._state=1,e._value=t,a(e)}catch(t){s(e,t)}}function s(e,t){e._state=2,e._value=t,a(e)}function a(e){2===e._state&&0===e._deferreds.length&&r._immediateFn((function(){e._handled||r._unhandledRejectionFn(e._value)}));for(var t=0,i=e._deferreds.length;t<i;t++)n(e,e._deferreds[t]);e._deferreds=null}function l(e,t,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=i}function u(e,t){var i=!1;try{e((function(e){i||(i=!0,o(t,e))}),(function(e){i||(i=!0,s(t,e))}))}catch(e){if(i)return;i=!0,s(t,e)}}var c=setTimeout;r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,i){var r=new this.constructor(t);return n(this,new l(e,i,r)),r},r.all=function(e){var t=Array.prototype.slice.call(e);return new r((function(e,r){function n(s,a){try{if(a&&("object"===(void 0===a?"undefined":i(a))||"function"==typeof a)){var l=a.then;if("function"==typeof l)return void l.call(a,(function(e){n(s,e)}),r)}t[s]=a,0==--o&&e(t)}catch(e){r(e)}}if(0===t.length)return e([]);for(var o=t.length,s=0;s<t.length;s++)n(s,t[s])}))},r.resolve=function(e){return e&&"object"===(void 0===e?"undefined":i(e))&&e.constructor===r?e:new r((function(t){t(e)}))},r.reject=function(e){return new r((function(t,i){i(e)}))},r.race=function(e){return new r((function(t,i){for(var r=0,n=e.length;r<n;r++)e[r].then(t,i)}))},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){c(e,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},r._setImmediateFn=function(e){r._immediateFn=e},r._setUnhandledRejectionFn=function(e){r._unhandledRejectionFn=e},"undefined"!=typeof module&&module.exports?module.exports=r:e.Promise||(e.Promise=r)}(window),function(e){e.Promise||(e.Promise=Promise);var r="required",n="email",o="minLength",s="maxLength",a="password",l="phone",u="remote",c="strength",d="function",h=function(e,t){if("string"==typeof e)return e;var i="post"===t.toLowerCase()?"":"?";return Array.isArray(e)?i+e.map((function(e){return e.name+"="+e.value})).join("&"):i+Object.keys(e).map((function(t){return t+"="+e[t]})).join("&")},f=function(e){var t=e.url,i=e.method,r=e.data,n=e.debug,o=e.callback,s=e.error;if(n)o("test");else{var a=!1!==e.async,l=new XMLHttpRequest,u=h(r,"get"),c=null;"post"===i.toLowerCase()&&(c=h(r,"post"),u=""),l.open(i,t+u,a),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.onreadystatechange=function(){4===this.readyState&&(200===this.status?o(this.responseText):s&&s(this.responseText))},l.send(c)}},m=function(e,t){this.options=t||{},this.rules=this.options.rules||{},this.messages=this.options.messages||void 0,this.colorWrong=this.options.colorWrong||"#B81111",this.result={},this.elements=[],this.tooltip=this.options.tooltip||{},this.tooltipFadeOutTime=this.tooltip.fadeOutTime||5e3,this.tooltipFadeOutClass=this.tooltip.fadeOutClass||"just-validate-tooltip-hide",this.tooltipSelectorWrap=document.querySelectorAll(this.tooltip.selectorWrap).length?document.querySelectorAll(this.tooltip.selectorWrap):document.querySelectorAll(".just-validate-tooltip-container"),this.bindHandlerKeyup=this.handlerKeyup.bind(this),this.submitHandler=this.options.submitHandler||void 0,this.invalidFormCallback=this.options.invalidFormCallback||void 0,this.promisesRemote=[],this.isValidationSuccess=!1,this.focusWrongField=this.options.focusWrongField||!1,this.REGEXP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,zip:/^\d{5}(-\d{4})?$/,phone:/^([0-9]( |-)?)?(\(?[0-9]{3}\)?|[0-9]{3})( |-)?([0-9]{3}( |-)?[0-9]{4}|[a-zA-Z0-9]{7})$/,password:/[^\w\d]*(([0-9]+.*[A-Za-z]+.*)|[A-Za-z]+.*([0-9]+.*))/,strengthPass:/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]/},this.DEFAULT_REMOTE_ERROR="Error",this.state={tooltipsTimer:null},this.setForm(document.querySelector(e))};m.prototype={defaultRules:{email:{required:!0,email:!0},name:{required:!0,minLength:3,maxLength:15},text:{required:!0,maxLength:300,minLength:5},password:{required:!0,password:!0,minLength:4,maxLength:8},zip:{required:!0,zip:!0},phone:{phone:!0}},defaultMessages:{required:"The field is required",email:"Please, type a valid email",maxLength:"The field must contain a maximum of :value characters",minLength:"The field must contain a minimum of :value characters",password:"Password is not valid",remote:"Email already exists",strength:"Password must contents at least one uppercase letter, one lowercase letter and one number",function:"Function returned false"},handlerKeyup:function(e){var t=e.target,i={name:t.getAttribute("data-validate-field"),value:t.value};delete this.result[i.name],this.validateItem({name:i.name,value:i.value,group:[],isKeyupChange:!0}),this.renderErrors()},setterEventListener:function(e,t,i,r){switch("keyup"===t&&(i=this.bindHandlerKeyup),r){case"add":e.addEventListener(t,i);break;case"remove":e.removeEventListener(t,i)}},getElementsRealValue:function(){for(var e=this.$form.querySelectorAll("*"),t=void 0,i={},r=0,n=e.length;r<n;++r)if(t=e[r].getAttribute("name")){if("checkbox"===e[r].type){i[t]=e[r].checked;continue}i[t]=e[r].value}return i},validationFailed:function(){this.invalidFormCallback&&this.invalidFormCallback(this.result);var e=document.querySelector(".js-validate-error-field");this.focusWrongField&&e&&e.focus&&e.focus()},validationSuccess:function(){if(0===Object.keys(this.result).length){if(this.isValidationSuccess=!1,this.submitHandler){var e=this.getElementsRealValue();return void this.submitHandler(this.$form,e,f)}this.$form.submit()}},setForm:function(e){var t=this;this.$form=e,this.$form.setAttribute("novalidate","novalidate"),this.$form.addEventListener("submit",(function(e){return e.preventDefault(),t.result=[],t.getElements(),t.promisesRemote.length?void Promise.all(t.promisesRemote).then((function(){t.promisesRemote=[],t.isValidationSuccess?t.validationSuccess():t.validationFailed()})):void(t.isValidationSuccess?t.validationSuccess():t.validationFailed())}))},isEmail:function(e){return this.REGEXP.email.test(e)},isZip:function(e){return this.REGEXP.zip.test(e)},isPhone:function(e){return this.REGEXP.phone.test(e)},isPassword:function(e){return this.REGEXP.password.test(e)},isEmpty:function(e){var t=e;return e.trim&&(t=e.trim()),!t},checkLengthMax:function(e,t){return e.length<=t},checkLengthMin:function(e,t){return e.length>=t},checkStrengthPass:function(e){return this.REGEXP.strengthPass.test(e)},getElements:function(){var e=this,t=this.$form.querySelectorAll("[data-validate-field]");this.elements=[];for(var i=function(i,r){var n=t[i],o=n.getAttribute("data-validate-field"),s=n.value,a=!1,l=[];if("checkbox"===n.type&&(s=n.checked||"",n.addEventListener("change",(function(t){var i=t.target,r={name:i.getAttribute("data-validate-field"),value:i.checked};delete e.result[r.name],e.validateItem({name:r.name,value:r.value,group:[]}),e.renderErrors()}))),"radio"===n.type){var u=e.elements.filter((function(e){if(e.name===o)return e}))[0];u?(u.group.push(n.checked),a=!0):l.push(n.checked),n.addEventListener("change",(function(t){var i=t.target,r={name:i.getAttribute("data-validate-field"),value:i.checked};delete e.result[r.name],e.validateItem({name:r.name,value:r.value,group:[]}),e.renderErrors()}))}e.setterEventListener(n,"keyup",e.handlerKeyup,"add"),a||e.elements.push({name:o,value:s,group:l})},r=0,n=t.length;r<n;++r)i(r);this.validateElements()},validateRequired:function(e){return!this.isEmpty(e)},validateEmail:function(e){return this.isEmail(e)},validatePhone:function(e){return this.isPhone(e)},validateMinLength:function(e,t){return this.checkLengthMin(e,t)},validateMaxLength:function(e,t){return this.checkLengthMax(e,t)},validateStrengthPass:function(e){return this.checkStrengthPass(e)},validatePassword:function(e){return this.isPassword(e)},validateZip:function(e){return this.isZip(e)},validateRemote:function(e){var i=e.value,r=e.name,n=e.url,o=e.successAnswer,s=e.sendParam,a=e.method;return new Promise((function(e){f({url:n,method:a,data:t({},s,i),async:!0,callback:function(t){t.toLowerCase()===o.toLowerCase()&&e("ok"),e({type:"incorrect",name:r})},error:function(){e({type:"error",name:r})}})}))},generateMessage:function(e,t,i){var r=this.messages||this.defaultMessages,n=r[t]&&r[t][e]||this.messages&&"string"==typeof this.messages[t]&&r[t]||this.defaultMessages[e]||this.DEFAULT_REMOTE_ERROR;i&&(n=n.replace(":value",i.toString())),this.result[t]={message:n}},validateElements:function(){var e=this;return this.lockForm(),this.elements.forEach((function(t){e.validateItem({name:t.name,value:t.value,group:t.group})})),this.promisesRemote.length?void Promise.all(this.promisesRemote).then((function(t){t.forEach((function(t){return"ok"===t||("error"===t.type&&alert("Server error occured. Please try later."),e.generateMessage(u,t.name)),void e.renderErrors()}))})):void this.renderErrors()},validateItem:function(e){var t=this,h=e.name,f=e.group,m=e.value,v=e.isKeyupChange,p=this.rules[h]||this.defaultRules[h]||!1;if(p)for(var g in p){var y=p[g];if(g!==r&&g!==d&&""==m)return;switch(g){case d:if("function"!=typeof y)break;if(y(h,m))break;return void this.generateMessage(d,h,y);case r:if(!y)break;if(f.length){var b=!1;if(f.forEach((function(e){t.validateRequired(e)&&(b=!0)})),b)break}else if(this.validateRequired(m))break;return void this.generateMessage(r,h);case n:if(!y)break;if(this.validateEmail(m))break;return void this.generateMessage(n,h);case o:if(!y)break;if(this.validateMinLength(m,y))break;return void this.generateMessage(o,h,y);case s:if(!y)break;if(this.validateMaxLength(m,y))break;return void this.generateMessage(s,h,y);case l:if(!y)break;if(this.validatePhone(m))break;return void this.generateMessage(l,h);case a:if(!y)break;if(this.validatePassword(m))break;return void this.generateMessage(a,h);case c:if(!y||"object"!==(void 0===y?"undefined":i(y)))break;if(y.default&&this.validateStrengthPass(m))break;if(y.custom){var E=void 0;try{E=new RegExp(y.custom)}catch(e){E=this.REGEXP.strengthPass,console.error("Custom regexp for strength rule is not valid. Default regexp was used.")}if(E.test(m))break}return void this.generateMessage(c,h);case"zip":if(!y)break;if(this.validateZip(m))break;return void this.generateMessage("zip",h);case u:if(v)break;if(!y)break;var w=y.url,k=y.successAnswer,S=y.method,P=y.sendParam,R=this.$form.querySelector('input[data-validate-field="'+h+'"]');return this.setterEventListener(R,"keyup",this.handlerKeyup,"remove"),void this.promisesRemote.push(this.validateRemote({name:h,value:m,url:w,method:S,sendParam:P,successAnswer:k}))}}},clearErrors:function(){for(var e=document.querySelectorAll(".js-validate-error-label"),t=0,i=e.length;t<i;++t)e[t].remove();for(var r=0,n=(e=document.querySelectorAll(".js-validate-error-field")).length;r<n;++r)e[r].classList.remove("js-validate-error-field"),e[r].style.border="",e[r].style.color=""},renderErrors:function(){var e=this;if(this.clearErrors(),this.unlockForm(),this.isValidationSuccess=!1,0!==Object.keys(this.result).length){for(var t in this.result){var i=this.result[t].message,r=this.$form.querySelectorAll('[data-validate-field="'+t+'"]'),n=r[r.length-1],o=document.createElement("div");if(o.innerHTML=i,o.className="js-validate-error-label",o.setAttribute("style","color: "+this.colorWrong),n.style.border="1px solid "+this.colorWrong,n.style.color=""+this.colorWrong,n.classList.add("js-validate-error-field"),"checkbox"===n.type||"radio"===n.type){var s=document.querySelector('label[for="'+n.getAttribute("id")+'"]');"label"===n.parentNode.tagName.toLowerCase()?n.parentNode.parentNode.insertBefore(o,null):s?s.parentNode.insertBefore(o,s.nextSibling):n.parentNode.insertBefore(o,n.nextSibling)}else n.parentNode.insertBefore(o,n.nextSibling)}this.tooltipSelectorWrap.length&&(this.state.tooltipsTimer=setTimeout((function(){e.hideTooltips()}),this.tooltipFadeOutTime))}else this.isValidationSuccess=!0},hideTooltips:function(){var e=this;document.querySelectorAll(".js-validate-error-label").forEach((function(t){t.classList.add(e.tooltipFadeOutClass)})),this.state.tooltipsTimer=null},lockForm:function(){for(var e=this.$form.querySelectorAll("input, textarea, button, select"),t=0,i=e.length;t<i;++t)e[t].setAttribute("disabled","disabled"),e[t].style.pointerEvents="none",e[t].style.webitFilter="grayscale(100%)",e[t].style.filter="grayscale(100%)"},unlockForm:function(){for(var e=this.$form.querySelectorAll("input, textarea, button, select"),t=0,i=e.length;t<i;++t)e[t].removeAttribute("disabled"),e[t].style.pointerEvents="",e[t].style.webitFilter="",e[t].style.filter=""}},e.JustValidate=m}(window);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImp1c3QtdmFsaWRhdGUubWluLmpzIl0sIm5hbWVzIjpbIl90eXBlb2YyIiwib2JqIiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJjb25zdHJ1Y3RvciIsInByb3RvdHlwZSIsIl9kZWZpbmVQcm9wZXJ0eSIsImUiLCJ0IiwiaSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJfdHlwZW9mIiwidGhpcyIsInBhcmVudE5vZGUiLCJyZW1vdmVDaGlsZCIsImxlbmd0aCIsInIiLCJ3aW5kb3ciLCJyZW1vdmUiLCJUeXBlRXJyb3IiLCJfc3RhdGUiLCJfaGFuZGxlZCIsIl92YWx1ZSIsIl9kZWZlcnJlZHMiLCJ1IiwibiIsInB1c2giLCJfaW1tZWRpYXRlRm4iLCJvbkZ1bGZpbGxlZCIsIm9uUmVqZWN0ZWQiLCJzIiwicHJvbWlzZSIsIm8iLCJ0aGVuIiwiYSIsImFwcGx5IiwiYXJndW1lbnRzIiwiX3VuaGFuZGxlZFJlamVjdGlvbkZuIiwibCIsImQiLCJzZXRUaW1lb3V0IiwiYWxsIiwiQXJyYXkiLCJzbGljZSIsImNhbGwiLCJyZXNvbHZlIiwicmVqZWN0IiwicmFjZSIsInNldEltbWVkaWF0ZSIsImNvbnNvbGUiLCJ3YXJuIiwiX3NldEltbWVkaWF0ZUZuIiwiX3NldFVuaGFuZGxlZFJlamVjdGlvbkZuIiwibW9kdWxlIiwiZXhwb3J0cyIsIlByb21pc2UiLCJjIiwidG9Mb3dlckNhc2UiLCJpc0FycmF5IiwibWFwIiwibmFtZSIsImpvaW4iLCJrZXlzIiwiaCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkZWJ1ZyIsImNhbGxiYWNrIiwiZXJyb3IiLCJhc3luYyIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsInNldFJlcXVlc3RIZWFkZXIiLCJvbnJlYWR5c3RhdGVjaGFuZ2UiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VUZXh0Iiwic2VuZCIsImYiLCJvcHRpb25zIiwicnVsZXMiLCJtZXNzYWdlcyIsImNvbG9yV3JvbmciLCJyZXN1bHQiLCJlbGVtZW50cyIsInRvb2x0aXAiLCJ0b29sdGlwRmFkZU91dFRpbWUiLCJmYWRlT3V0VGltZSIsInRvb2x0aXBGYWRlT3V0Q2xhc3MiLCJmYWRlT3V0Q2xhc3MiLCJ0b29sdGlwU2VsZWN0b3JXcmFwIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwic2VsZWN0b3JXcmFwIiwiYmluZEhhbmRsZXJLZXl1cCIsImhhbmRsZXJLZXl1cCIsImJpbmQiLCJzdWJtaXRIYW5kbGVyIiwiaW52YWxpZEZvcm1DYWxsYmFjayIsInByb21pc2VzUmVtb3RlIiwiaXNWYWxpZGF0aW9uU3VjY2VzcyIsImZvY3VzV3JvbmdGaWVsZCIsIlJFR0VYUCIsImVtYWlsIiwiemlwIiwicGhvbmUiLCJwYXNzd29yZCIsInN0cmVuZ3RoUGFzcyIsIkRFRkFVTFRfUkVNT1RFX0VSUk9SIiwic3RhdGUiLCJ0b29sdGlwc1RpbWVyIiwic2V0Rm9ybSIsInF1ZXJ5U2VsZWN0b3IiLCJkZWZhdWx0UnVsZXMiLCJyZXF1aXJlZCIsIm1pbkxlbmd0aCIsIm1heExlbmd0aCIsInRleHQiLCJkZWZhdWx0TWVzc2FnZXMiLCJyZW1vdGUiLCJzdHJlbmd0aCIsImZ1bmN0aW9uIiwidGFyZ2V0IiwiZ2V0QXR0cmlidXRlIiwidmFsaWRhdGVJdGVtIiwiZ3JvdXAiLCJpc0tleXVwQ2hhbmdlIiwicmVuZGVyRXJyb3JzIiwic2V0dGVyRXZlbnRMaXN0ZW5lciIsImFkZEV2ZW50TGlzdGVuZXIiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZ2V0RWxlbWVudHNSZWFsVmFsdWUiLCIkZm9ybSIsInR5cGUiLCJjaGVja2VkIiwidmFsaWRhdGlvbkZhaWxlZCIsImZvY3VzIiwidmFsaWRhdGlvblN1Y2Nlc3MiLCJzdWJtaXQiLCJzZXRBdHRyaWJ1dGUiLCJwcmV2ZW50RGVmYXVsdCIsImdldEVsZW1lbnRzIiwiaXNFbWFpbCIsInRlc3QiLCJpc1ppcCIsImlzUGhvbmUiLCJpc1Bhc3N3b3JkIiwiaXNFbXB0eSIsInRyaW0iLCJjaGVja0xlbmd0aE1heCIsImNoZWNrTGVuZ3RoTWluIiwiY2hlY2tTdHJlbmd0aFBhc3MiLCJfaSIsImZpbHRlciIsInZhbGlkYXRlRWxlbWVudHMiLCJ2YWxpZGF0ZVJlcXVpcmVkIiwidmFsaWRhdGVFbWFpbCIsInZhbGlkYXRlUGhvbmUiLCJ2YWxpZGF0ZU1pbkxlbmd0aCIsInZhbGlkYXRlTWF4TGVuZ3RoIiwidmFsaWRhdGVTdHJlbmd0aFBhc3MiLCJ2YWxpZGF0ZVBhc3N3b3JkIiwidmFsaWRhdGVaaXAiLCJ2YWxpZGF0ZVJlbW90ZSIsInN1Y2Nlc3NBbnN3ZXIiLCJzZW5kUGFyYW0iLCJnZW5lcmF0ZU1lc3NhZ2UiLCJyZXBsYWNlIiwidG9TdHJpbmciLCJtZXNzYWdlIiwibG9ja0Zvcm0iLCJmb3JFYWNoIiwiYWxlcnQiLCJtIiwidiIsInAiLCJnIiwieSIsImIiLCJjdXN0b20iLCJFIiwiUmVnRXhwIiwidyIsImsiLCJfIiwiUCIsIlIiLCJTIiwiY2xlYXJFcnJvcnMiLCJjbGFzc0xpc3QiLCJzdHlsZSIsImJvcmRlciIsImNvbG9yIiwidW5sb2NrRm9ybSIsImNyZWF0ZUVsZW1lbnQiLCJpbm5lckhUTUwiLCJjbGFzc05hbWUiLCJhZGQiLCJ0YWdOYW1lIiwiaW5zZXJ0QmVmb3JlIiwibmV4dFNpYmxpbmciLCJoaWRlVG9vbHRpcHMiLCJwb2ludGVyRXZlbnRzIiwid2ViaXRGaWx0ZXIiLCJyZW1vdmVBdHRyaWJ1dGUiLCJKdXN0VmFsaWRhdGUiXSwibWFwcGluZ3MiOiJBQUFBLGFBRUEsU0FBQUEsRUFBQUMsR0FBQSxPQUFBRCxFQUFBLG1CQUFBRSxRQUFBLGlCQUFBQSxPQUFBQyxTQUFBLFNBQUFGLEdBQUEsY0FBQUEsR0FBQSxTQUFBQSxHQUFBLE9BQUFBLEdBQUEsbUJBQUFDLFFBQUFELEVBQUFHLGNBQUFGLFFBQUFELElBQUFDLE9BQUFHLFVBQUEsZ0JBQUFKLElBQUFBLEdBRUEsU0FBQUssRUFBQUMsRUFBQUMsRUFBQUMs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QUYsRUFBQWEsT0FBQVosRUFBQUMsSUFBQUQsRUFDQUQsRUFBQUMsR0FBQTBNLGdCQUFBLFlBQUEzTSxFQUFBQyxHQUFBNEwsTUFBQVksY0FBQSxHQUFBek0sRUFBQUMsR0FBQTRMLE1BQUFhLFlBQUEsR0FBQTFNLEVBQUFDLEdBQUE0TCxNQUFBckMsT0FBQSxLQUdBeEosRUFBQTRNLGFBQUEvSCxFQTViQSxDQTZiQTlEIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfdHlwZW9mMihvYmopIHsgXCJAYmFiZWwvaGVscGVycyAtIHR5cGVvZlwiOyBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHsgX3R5cGVvZjIgPSBmdW5jdGlvbiBfdHlwZW9mMihvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH07IH0gZWxzZSB7IF90eXBlb2YyID0gZnVuY3Rpb24gX3R5cGVvZjIob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9OyB9IHJldHVybiBfdHlwZW9mMihvYmopOyB9XG5cbmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShlLCB0LCBpKSB7XG4gIHJldHVybiB0IGluIGUgPyBPYmplY3QuZGVmaW5lUHJvcGVydHkoZSwgdCwge1xuICAgIHZhbHVlOiBpLFxuICAgIGVudW1lcmFibGU6ICEwLFxuICAgIGNvbmZpZ3VyYWJsZTogITAsXG4gICAgd3JpdGFibGU6ICEwXG4gIH0pIDogZVt0XSA9IGksIGU7XG59XG5cbnZhciBfdHlwZW9mID0gXCJmdW5jdGlvblwiID09IHR5cGVvZiBTeW1ib2wgJiYgXCJzeW1ib2xcIiA9PSBfdHlwZW9mMihTeW1ib2wuaXRlcmF0b3IpID8gZnVuY3Rpb24gKGUpIHtcbiAgcmV0dXJuIF90eXBlb2YyKGUpO1xufSA6IGZ1bmN0aW9uIChlKSB7XG4gIHJldHVybiBlICYmIFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgU3ltYm9sICYmIGUuY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBlICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IF90eXBlb2YyKGUpO1xufTtcblxuIWZ1bmN0aW9uICgpIHtcbiAgZm9yICh2YXIgZSA9IFtcIkRvY3VtZW50VHlwZVwiLCBcIkVsZW1lbnRcIiwgXCJDaGFyYWN0ZXJEYXRhXCJdLCB0ID0gZnVuY3Rpb24gdCgpIHtcbiAgICBudWxsICE9IHRoaXMucGFyZW50Tm9kZSAmJiB0aGlzLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcyk7XG4gIH0sIGkgPSAwOyBpIDwgZS5sZW5ndGg7IGkrKykge1xuICAgIHZhciByID0gZVtpXTtcbiAgICB3aW5kb3dbcl0gJiYgIXdpbmRvd1tyXS5wcm90b3R5cGUucmVtb3ZlICYmICh3aW5kb3dbcl0ucHJvdG90eXBlLnJlbW92ZSA9IHQpO1xuICB9XG59KCksIGZ1bmN0aW9uIChlKSB7XG4gIGZ1bmN0aW9uIHQoKSB7fVxuXG4gIGZ1bmN0aW9uIGkoZSwgdCkge1xuICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICBlLmFwcGx5KHQsIGFyZ3VtZW50cyk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHIoZSkge1xuICAgIGlmIChcIm9iamVjdFwiICE9PSBfdHlwZW9mKHRoaXMpKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiUHJvbWlzZXMgbXVzdCBiZSBjb25zdHJ1Y3RlZCB2aWEgbmV3XCIpO1xuICAgIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIGUpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJub3QgYSBmdW5jdGlvblwiKTtcbiAgICB0aGlzLl9zdGF0ZSA9IDAsIHRoaXMuX2hhbmRsZWQgPSAhMSwgdGhpcy5fdmFsdWUgPSB2b2lkIDAsIHRoaXMuX2RlZmVycmVkcyA9IFtdLCB1KGUsIHRoaXMpO1xuICB9XG5cbiAgZnVuY3Rpb24gbihlLCB0KSB7XG4gICAgZm9yICg7IDMgPT09IGUuX3N0YXRlOykge1xuICAgICAgZSA9IGUuX3ZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiAwID09PSBlLl9zdGF0ZSA/IHZvaWQgZS5fZGVmZXJyZWRzLnB1c2godCkgOiAoZS5faGFuZGxlZCA9ICEwLCB2b2lkIHIuX2ltbWVkaWF0ZUZuKGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBpID0gMSA9PT0gZS5fc3RhdGUgPyB0Lm9uRnVsZmlsbGVkIDogdC5vblJlamVjdGVkO1xuICAgICAgaWYgKG51bGwgPT09IGkpIHJldHVybiB2b2lkICgxID09PSBlLl9zdGF0ZSA/IG8gOiBzKSh0LnByb21pc2UsIGUuX3ZhbHVlKTtcbiAgICAgIHZhciByO1xuXG4gICAgICB0cnkge1xuICAgICAgICByID0gaShlLl92YWx1ZSk7XG4gICAgICB9IGNhdGNoIChuKSB7XG4gICAgICAgIHJldHVybiB2b2lkIHModC5wcm9taXNlLCBuKTtcbiAgICAgIH1cblxuICAgICAgbyh0LnByb21pc2UsIHIpO1xuICAgIH0pKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG8oZSwgdCkge1xuICAgIHRyeSB7XG4gICAgICBpZiAodCA9PT0gZSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkEgcHJvbWlzZSBjYW5ub3QgYmUgcmVzb2x2ZWQgd2l0aCBpdHNlbGYuXCIpO1xuXG4gICAgICBpZiAodCAmJiAoXCJvYmplY3RcIiA9PT0gKFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIHQgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZih0KSkgfHwgXCJmdW5jdGlvblwiID09IHR5cGVvZiB0KSkge1xuICAgICAgICB2YXIgbiA9IHQudGhlbjtcbiAgICAgICAgaWYgKHQgaW5zdGFuY2VvZiByKSByZXR1cm4gZS5fc3RhdGUgPSAzLCBlLl92YWx1ZSA9IHQsIHZvaWQgYShlKTtcbiAgICAgICAgaWYgKFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgbikgcmV0dXJuIHZvaWQgdShpKG4sIHQpLCBlKTtcbiAgICAgIH1cblxuICAgICAgZS5fc3RhdGUgPSAxLCBlLl92YWx1ZSA9IHQsIGEoZSk7XG4gICAgfSBjYXRjaCAobykge1xuICAgICAgcyhlLCBvKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBzKGUsIHQpIHtcbiAgICBlLl9zdGF0ZSA9IDIsIGUuX3ZhbHVlID0gdCwgYShlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGEoZSkge1xuICAgIDIgPT09IGUuX3N0YXRlICYmIDAgPT09IGUuX2RlZmVycmVkcy5sZW5ndGggJiYgci5faW1tZWRpYXRlRm4oZnVuY3Rpb24gKCkge1xuICAgICAgZS5faGFuZGxlZCB8fCByLl91bmhhbmRsZWRSZWplY3Rpb25GbihlLl92YWx1ZSk7XG4gICAgfSk7XG5cbiAgICBmb3IgKHZhciB0ID0gMCwgaSA9IGUuX2RlZmVycmVkcy5sZW5ndGg7IHQgPCBpOyB0KyspIHtcbiAgICAgIG4oZSwgZS5fZGVmZXJyZWRzW3RdKTtcbiAgICB9XG5cbiAgICBlLl9kZWZlcnJlZHMgPSBudWxsO1xuICB9XG5cbiAgZnVuY3Rpb24gbChlLCB0LCBpKSB7XG4gICAgdGhpcy5vbkZ1bGZpbGxlZCA9IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2YgZSA/IGUgOiBudWxsLCB0aGlzLm9uUmVqZWN0ZWQgPSBcImZ1bmN0aW9uXCIgPT0gdHlwZW9mIHQgPyB0IDogbnVsbCwgdGhpcy5wcm9taXNlID0gaTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHUoZSwgdCkge1xuICAgIHZhciBpID0gITE7XG5cbiAgICB0cnkge1xuICAgICAgZShmdW5jdGlvbiAoZSkge1xuICAgICAgICBpIHx8IChpID0gITAsIG8odCwgZSkpO1xuICAgICAgfSwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgaSB8fCAoaSA9ICEwLCBzKHQsIGUpKTtcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKHIpIHtcbiAgICAgIGlmIChpKSByZXR1cm47XG4gICAgICBpID0gITAsIHModCwgcik7XG4gICAgfVxuICB9XG5cbiAgdmFyIGQgPSBzZXRUaW1lb3V0O1xuICByLnByb3RvdHlwZVtcImNhdGNoXCJdID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gdGhpcy50aGVuKG51bGwsIGUpO1xuICB9LCByLnByb3RvdHlwZS50aGVuID0gZnVuY3Rpb24gKGUsIGkpIHtcbiAgICB2YXIgciA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKHQpO1xuICAgIHJldHVybiBuKHRoaXMsIG5ldyBsKGUsIGksIHIpKSwgcjtcbiAgfSwgci5hbGwgPSBmdW5jdGlvbiAoZSkge1xuICAgIHZhciB0ID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZSk7XG4gICAgcmV0dXJuIG5ldyByKGZ1bmN0aW9uIChlLCBpKSB7XG4gICAgICBmdW5jdGlvbiByKG8sIHMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAocyAmJiAoXCJvYmplY3RcIiA9PT0gKFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIHMgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihzKSkgfHwgXCJmdW5jdGlvblwiID09IHR5cGVvZiBzKSkge1xuICAgICAgICAgICAgdmFyIGEgPSBzLnRoZW47XG4gICAgICAgICAgICBpZiAoXCJmdW5jdGlvblwiID09IHR5cGVvZiBhKSByZXR1cm4gdm9pZCBhLmNhbGwocywgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgcihvLCBlKTtcbiAgICAgICAgICAgIH0sIGkpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRbb10gPSBzLCAwID09PSAtLW4gJiYgZSh0KTtcbiAgICAgICAgfSBjYXRjaCAobCkge1xuICAgICAgICAgIGkobCk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKDAgPT09IHQubGVuZ3RoKSByZXR1cm4gZShbXSk7XG5cbiAgICAgIGZvciAodmFyIG4gPSB0Lmxlbmd0aCwgbyA9IDA7IG8gPCB0Lmxlbmd0aDsgbysrKSB7XG4gICAgICAgIHIobywgdFtvXSk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sIHIucmVzb2x2ZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgcmV0dXJuIGUgJiYgXCJvYmplY3RcIiA9PT0gKFwidW5kZWZpbmVkXCIgPT0gdHlwZW9mIGUgPyBcInVuZGVmaW5lZFwiIDogX3R5cGVvZihlKSkgJiYgZS5jb25zdHJ1Y3RvciA9PT0gciA/IGUgOiBuZXcgcihmdW5jdGlvbiAodCkge1xuICAgICAgdChlKTtcbiAgICB9KTtcbiAgfSwgci5yZWplY3QgPSBmdW5jdGlvbiAoZSkge1xuICAgIHJldHVybiBuZXcgcihmdW5jdGlvbiAodCwgaSkge1xuICAgICAgaShlKTtcbiAgICB9KTtcbiAgfSwgci5yYWNlID0gZnVuY3Rpb24gKGUpIHtcbiAgICByZXR1cm4gbmV3IHIoZnVuY3Rpb24gKHQsIGkpIHtcbiAgICAgIGZvciAodmFyIHIgPSAwLCBuID0gZS5sZW5ndGg7IHIgPCBuOyByKyspIHtcbiAgICAgICAgZVtyXS50aGVuKHQsIGkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9LCByLl9pbW1lZGlhdGVGbiA9IFwiZnVuY3Rpb25cIiA9PSB0eXBlb2Ygc2V0SW1tZWRpYXRlICYmIGZ1bmN0aW9uIChlKSB7XG4gICAgc2V0SW1tZWRpYXRlKGUpO1xuICB9IHx8IGZ1bmN0aW9uIChlKSB7XG4gICAgZChlLCAwKTtcbiAgfSwgci5fdW5oYW5kbGVkUmVqZWN0aW9uRm4gPSBmdW5jdGlvbiAoZSkge1xuICAgIFwidW5kZWZpbmVkXCIgIT0gdHlwZW9mIGNvbnNvbGUgJiYgY29uc29sZSAmJiBjb25zb2xlLndhcm4oXCJQb3NzaWJsZSBVbmhhbmRsZWQgUHJvbWlzZSBSZWplY3Rpb246XCIsIGUpO1xuICB9LCByLl9zZXRJbW1lZGlhdGVGbiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgci5faW1tZWRpYXRlRm4gPSBlO1xuICB9LCByLl9zZXRVbmhhbmRsZWRSZWplY3Rpb25GbiA9IGZ1bmN0aW9uIChlKSB7XG4gICAgci5fdW5oYW5kbGVkUmVqZWN0aW9uRm4gPSBlO1xuICB9LCBcInVuZGVmaW5lZFwiICE9IHR5cGVvZiBtb2R1bGUgJiYgbW9kdWxlLmV4cG9ydHMgPyBtb2R1bGUuZXhwb3J0cyA9IHIgOiBlLlByb21pc2UgfHwgKGUuUHJvbWlzZSA9IHIpO1xufSh3aW5kb3cpLCBmdW5jdGlvbiAoZSkge1xuICBlLlByb21pc2UgfHwgKGUuUHJvbWlzZSA9IFByb21pc2UpO1xuXG4gIHZhciB0ID0gXCJyZXF1aXJlZFwiLFxuICAgICAgaSA9IFwiZW1haWxcIixcbiAgICAgIHIgPSBcIm1pbkxlbmd0aFwiLFxuICAgICAgbiA9IFwibWF4TGVuZ3RoXCIsXG4gICAgICBvID0gXCJwYXNzd29yZFwiLFxuICAgICAgcyA9IFwiemlwXCIsXG4gICAgICBhID0gXCJwaG9uZVwiLFxuICAgICAgbCA9IFwicmVtb3RlXCIsXG4gICAgICB1ID0gXCJzdHJlbmd0aFwiLFxuICAgICAgZCA9IFwiZnVuY3Rpb25cIixcbiAgICAgIGMgPSBmdW5jdGlvbiBjKGUsIHQpIHtcbiAgICBpZiAoXCJzdHJpbmdcIiA9PSB0eXBlb2YgZSkgcmV0dXJuIGU7XG4gICAgdmFyIGkgPSBcInBvc3RcIiA9PT0gdC50b0xvd2VyQ2FzZSgpID8gXCJcIiA6IFwiP1wiO1xuICAgIHJldHVybiBBcnJheS5pc0FycmF5KGUpID8gaSArIGUubWFwKGZ1bmN0aW9uIChlKSB7XG4gICAgICByZXR1cm4gZS5uYW1lICsgXCI9XCIgKyBlLnZhbHVlO1xuICAgIH0pLmpvaW4oXCImXCIpIDogaSArIE9iamVjdC5rZXlzKGUpLm1hcChmdW5jdGlvbiAodCkge1xuICAgICAgcmV0dXJuIHQgKyBcIj1cIiArIGVbdF07XG4gICAgfSkuam9pbihcIiZcIik7XG4gIH0sXG4gICAgICBoID0gZnVuY3Rpb24gaChlKSB7XG4gICAgdmFyIHQgPSBlLnVybCxcbiAgICAgICAgaSA9IGUubWV0aG9kLFxuICAgICAgICByID0gZS5kYXRhLFxuICAgICAgICBuID0gZS5kZWJ1ZyxcbiAgICAgICAgbyA9IGUuY2FsbGJhY2ssXG4gICAgICAgIHMgPSBlLmVycm9yO1xuICAgIGlmIChuKSByZXR1cm4gdm9pZCBvKFwidGVzdFwiKTtcbiAgICB2YXIgYSA9IGUuYXN5bmMgIT09ICExLFxuICAgICAgICBsID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCksXG4gICAgICAgIHUgPSBjKHIsIFwiZ2V0XCIpLFxuICAgICAgICBkID0gbnVsbDtcbiAgICBcInBvc3RcIiA9PT0gaS50b0xvd2VyQ2FzZSgpICYmIChkID0gYyhyLCBcInBvc3RcIiksIHUgPSBcIlwiKSwgbC5vcGVuKGksIHQgKyB1LCBhKSwgbC5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsIFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIpLCBsLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgIDQgPT09IHRoaXMucmVhZHlTdGF0ZSAmJiAoMjAwID09PSB0aGlzLnN0YXR1cyA/IG8odGhpcy5yZXNwb25zZVRleHQpIDogcyAmJiBzKHRoaXMucmVzcG9uc2VUZXh0KSk7XG4gICAgfSwgbC5zZW5kKGQpO1xuICB9LFxuICAgICAgZiA9IGZ1bmN0aW9uIGYoZSwgdCkge1xuICAgIHRoaXMub3B0aW9ucyA9IHQgfHwge30sIHRoaXMucnVsZXMgPSB0aGlzLm9wdGlvbnMucnVsZXMgfHwge30sIHRoaXMubWVzc2FnZXMgPSB0aGlzLm9wdGlvbnMubWVzc2FnZXMgfHwgdm9pZCAwLCB0aGlzLmNvbG9yV3JvbmcgPSB0aGlzLm9wdGlvbnMuY29sb3JXcm9uZyB8fCBcIiNCODExMTFcIiwgdGhpcy5yZXN1bHQgPSB7fSwgdGhpcy5lbGVtZW50cyA9IFtdLCB0aGlzLnRvb2x0aXAgPSB0aGlzLm9wdGlvbnMudG9vbHRpcCB8fCB7fSwgdGhpcy50b29sdGlwRmFkZU91dFRpbWUgPSB0aGlzLnRvb2x0aXAuZmFkZU91dFRpbWUgfHwgNWUzLCB0aGlzLnRvb2x0aXBGYWRlT3V0Q2xhc3MgPSB0aGlzLnRvb2x0aXAuZmFkZU91dENsYXNzIHx8IFwianVzdC12YWxpZGF0ZS10b29sdGlwLWhpZGVcIiwgdGhpcy50b29sdGlwU2VsZWN0b3JXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLnRvb2x0aXAuc2VsZWN0b3JXcmFwKS5sZW5ndGggPyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMudG9vbHRpcC5zZWxlY3RvcldyYXApIDogZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5qdXN0LXZhbGlkYXRlLXRvb2x0aXAtY29udGFpbmVyXCIpLCB0aGlzLmJpbmRIYW5kbGVyS2V5dXAgPSB0aGlzLmhhbmRsZXJLZXl1cC5iaW5kKHRoaXMpLCB0aGlzLnN1Ym1pdEhhbmRsZXIgPSB0aGlzLm9wdGlvbnMuc3VibWl0SGFuZGxlciB8fCB2b2lkIDAsIHRoaXMuaW52YWxpZEZvcm1DYWxsYmFjayA9IHRoaXMub3B0aW9ucy5pbnZhbGlkRm9ybUNhbGxiYWNrIHx8IHZvaWQgMCwgdGhpcy5wcm9taXNlc1JlbW90ZSA9IFtdLCB0aGlzLmlzVmFsaWRhdGlvblN1Y2Nlc3MgPSAhMSwgdGhpcy5mb2N1c1dyb25nRmllbGQgPSB0aGlzLm9wdGlvbnMuZm9jdXNXcm9uZ0ZpZWxkIHx8ICExLCB0aGlzLlJFR0VYUCA9IHtcbiAgICAgIGVtYWlsOiAvXigoW148PigpXFxbXFxdXFxcXC4sOzpcXHNAXCJdKyhcXC5bXjw+KClcXFtcXF1cXFxcLiw7Olxcc0BcIl0rKSopfChcIi4rXCIpKUAoKFxcW1swLTldezEsM31cXC5bMC05XXsxLDN9XFwuWzAtOV17MSwzfVxcLlswLTldezEsM31dKXwoKFthLXpBLVpcXC0wLTldK1xcLikrW2EtekEtWl17Mix9KSkkLyxcbiAgICAgIHppcDogL15cXGR7NX0oLVxcZHs0fSk/JC8sXG4gICAgICBwaG9uZTogL14oWzAtOV0oIHwtKT8pPyhcXCg/WzAtOV17M31cXCk/fFswLTldezN9KSggfC0pPyhbMC05XXszfSggfC0pP1swLTldezR9fFthLXpBLVowLTldezd9KSQvLFxuICAgICAgcGFzc3dvcmQ6IC9bXlxcd1xcZF0qKChbMC05XSsuKltBLVphLXpdKy4qKXxbQS1aYS16XSsuKihbMC05XSsuKikpLyxcbiAgICAgIHN0cmVuZ3RoUGFzczogL14oPz0uKlthLXpdKSg/PS4qW0EtWl0pKD89LipcXGQpW2EtekEtWlxcZF0vXG4gICAgfSwgdGhpcy5ERUZBVUxUX1JFTU9URV9FUlJPUiA9IFwiRXJyb3JcIiwgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHRvb2x0aXBzVGltZXI6IG51bGxcbiAgICB9LCB0aGlzLnNldEZvcm0oZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlKSk7XG4gIH07XG5cbiAgZi5wcm90b3R5cGUgPSB7XG4gICAgZGVmYXVsdFJ1bGVzOiB7XG4gICAgICBlbWFpbDoge1xuICAgICAgICByZXF1aXJlZDogITAsXG4gICAgICAgIGVtYWlsOiAhMFxuICAgICAgfSxcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgcmVxdWlyZWQ6ICEwLFxuICAgICAgICBtaW5MZW5ndGg6IDMsXG4gICAgICAgIG1heExlbmd0aDogMTVcbiAgICAgIH0sXG4gICAgICB0ZXh0OiB7XG4gICAgICAgIHJlcXVpcmVkOiAhMCxcbiAgICAgICAgbWF4TGVuZ3RoOiAzMDAsXG4gICAgICAgIG1pbkxlbmd0aDogNVxuICAgICAgfSxcbiAgICAgIHBhc3N3b3JkOiB7XG4gICAgICAgIHJlcXVpcmVkOiAhMCxcbiAgICAgICAgcGFzc3dvcmQ6ICEwLFxuICAgICAgICBtaW5MZW5ndGg6IDQsXG4gICAgICAgIG1heExlbmd0aDogOFxuICAgICAgfSxcbiAgICAgIHppcDoge1xuICAgICAgICByZXF1aXJlZDogITAsXG4gICAgICAgIHppcDogITBcbiAgICAgIH0sXG4gICAgICBwaG9uZToge1xuICAgICAgICBwaG9uZTogITBcbiAgICAgIH1cbiAgICB9LFxuICAgIGRlZmF1bHRNZXNzYWdlczoge1xuICAgICAgcmVxdWlyZWQ6IFwiVGhlIGZpZWxkIGlzIHJlcXVpcmVkXCIsXG4gICAgICBlbWFpbDogXCJQbGVhc2UsIHR5cGUgYSB2YWxpZCBlbWFpbFwiLFxuICAgICAgbWF4TGVuZ3RoOiBcIlRoZSBmaWVsZCBtdXN0IGNvbnRhaW4gYSBtYXhpbXVtIG9mIDp2YWx1ZSBjaGFyYWN0ZXJzXCIsXG4gICAgICBtaW5MZW5ndGg6IFwiVGhlIGZpZWxkIG11c3QgY29udGFpbiBhIG1pbmltdW0gb2YgOnZhbHVlIGNoYXJhY3RlcnNcIixcbiAgICAgIHBhc3N3b3JkOiBcIlBhc3N3b3JkIGlzIG5vdCB2YWxpZFwiLFxuICAgICAgcmVtb3RlOiBcIkVtYWlsIGFscmVhZHkgZXhpc3RzXCIsXG4gICAgICBzdHJlbmd0aDogXCJQYXNzd29yZCBtdXN0IGNvbnRlbnRzIGF0IGxlYXN0IG9uZSB1cHBlcmNhc2UgbGV0dGVyLCBvbmUgbG93ZXJjYXNlIGxldHRlciBhbmQgb25lIG51bWJlclwiLFxuICAgICAgXCJmdW5jdGlvblwiOiBcIkZ1bmN0aW9uIHJldHVybmVkIGZhbHNlXCJcbiAgICB9LFxuICAgIGhhbmRsZXJLZXl1cDogZnVuY3Rpb24gaGFuZGxlcktleXVwKGUpIHtcbiAgICAgIHZhciB0ID0gZS50YXJnZXQsXG4gICAgICAgICAgaSA9IHtcbiAgICAgICAgbmFtZTogdC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXZhbGlkYXRlLWZpZWxkXCIpLFxuICAgICAgICB2YWx1ZTogdC52YWx1ZVxuICAgICAgfTtcbiAgICAgIGRlbGV0ZSB0aGlzLnJlc3VsdFtpLm5hbWVdLCB0aGlzLnZhbGlkYXRlSXRlbSh7XG4gICAgICAgIG5hbWU6IGkubmFtZSxcbiAgICAgICAgdmFsdWU6IGkudmFsdWUsXG4gICAgICAgIGdyb3VwOiBbXSxcbiAgICAgICAgaXNLZXl1cENoYW5nZTogITBcbiAgICAgIH0pLCB0aGlzLnJlbmRlckVycm9ycygpO1xuICAgIH0sXG4gICAgc2V0dGVyRXZlbnRMaXN0ZW5lcjogZnVuY3Rpb24gc2V0dGVyRXZlbnRMaXN0ZW5lcihlLCB0LCBpLCByKSB7XG4gICAgICBzd2l0Y2ggKFwia2V5dXBcIiA9PT0gdCAmJiAoaSA9IHRoaXMuYmluZEhhbmRsZXJLZXl1cCksIHIpIHtcbiAgICAgICAgY2FzZSBcImFkZFwiOlxuICAgICAgICAgIGUuYWRkRXZlbnRMaXN0ZW5lcih0LCBpKTtcbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIFwicmVtb3ZlXCI6XG4gICAgICAgICAgZS5yZW1vdmVFdmVudExpc3RlbmVyKHQsIGkpO1xuICAgICAgfVxuICAgIH0sXG4gICAgZ2V0RWxlbWVudHNSZWFsVmFsdWU6IGZ1bmN0aW9uIGdldEVsZW1lbnRzUmVhbFZhbHVlKCkge1xuICAgICAgZm9yICh2YXIgZSA9IHRoaXMuJGZvcm0ucXVlcnlTZWxlY3RvckFsbChcIipcIiksIHQgPSB2b2lkIDAsIGkgPSB7fSwgciA9IDAsIG4gPSBlLmxlbmd0aDsgciA8IG47ICsrcikge1xuICAgICAgICBpZiAodCA9IGVbcl0uZ2V0QXR0cmlidXRlKFwibmFtZVwiKSkge1xuICAgICAgICAgIGlmIChcImNoZWNrYm94XCIgPT09IGVbcl0udHlwZSkge1xuICAgICAgICAgICAgaVt0XSA9IGVbcl0uY2hlY2tlZDtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlbdF0gPSBlW3JdLnZhbHVlO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBpO1xuICAgIH0sXG4gICAgdmFsaWRhdGlvbkZhaWxlZDogZnVuY3Rpb24gdmFsaWRhdGlvbkZhaWxlZCgpIHtcbiAgICAgIHRoaXMuaW52YWxpZEZvcm1DYWxsYmFjayAmJiB0aGlzLmludmFsaWRGb3JtQ2FsbGJhY2sodGhpcy5yZXN1bHQpO1xuICAgICAgdmFyIGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmpzLXZhbGlkYXRlLWVycm9yLWZpZWxkXCIpO1xuICAgICAgdGhpcy5mb2N1c1dyb25nRmllbGQgJiYgZSAmJiBlLmZvY3VzICYmIGUuZm9jdXMoKTtcbiAgICB9LFxuICAgIHZhbGlkYXRpb25TdWNjZXNzOiBmdW5jdGlvbiB2YWxpZGF0aW9uU3VjY2VzcygpIHtcbiAgICAgIGlmICgwID09PSBPYmplY3Qua2V5cyh0aGlzLnJlc3VsdCkubGVuZ3RoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzVmFsaWRhdGlvblN1Y2Nlc3MgPSAhMSwgdGhpcy5zdWJtaXRIYW5kbGVyKSB7XG4gICAgICAgICAgdmFyIGUgPSB0aGlzLmdldEVsZW1lbnRzUmVhbFZhbHVlKCk7XG4gICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy5zdWJtaXRIYW5kbGVyKHRoaXMuJGZvcm0sIGUsIGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4kZm9ybS5zdWJtaXQoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNldEZvcm06IGZ1bmN0aW9uIHNldEZvcm0oZSkge1xuICAgICAgdmFyIHQgPSB0aGlzO1xuICAgICAgdGhpcy4kZm9ybSA9IGUsIHRoaXMuJGZvcm0uc2V0QXR0cmlidXRlKFwibm92YWxpZGF0ZVwiLCBcIm5vdmFsaWRhdGVcIiksIHRoaXMuJGZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBmdW5jdGlvbiAoZSkge1xuICAgICAgICByZXR1cm4gZS5wcmV2ZW50RGVmYXVsdCgpLCB0LnJlc3VsdCA9IFtdLCB0LmdldEVsZW1lbnRzKCksIHQucHJvbWlzZXNSZW1vdGUubGVuZ3RoID8gdm9pZCBQcm9taXNlLmFsbCh0LnByb21pc2VzUmVtb3RlKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0LnByb21pc2VzUmVtb3RlID0gW10sIHQuaXNWYWxpZGF0aW9uU3VjY2VzcyA/IHQudmFsaWRhdGlvblN1Y2Nlc3MoKSA6IHQudmFsaWRhdGlvbkZhaWxlZCgpO1xuICAgICAgICB9KSA6IHZvaWQgKHQuaXNWYWxpZGF0aW9uU3VjY2VzcyA/IHQudmFsaWRhdGlvblN1Y2Nlc3MoKSA6IHQudmFsaWRhdGlvbkZhaWxlZCgpKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgaXNFbWFpbDogZnVuY3Rpb24gaXNFbWFpbChlKSB7XG4gICAgICByZXR1cm4gdGhpcy5SRUdFWFAuZW1haWwudGVzdChlKTtcbiAgICB9LFxuICAgIGlzWmlwOiBmdW5jdGlvbiBpc1ppcChlKSB7XG4gICAgICByZXR1cm4gdGhpcy5SRUdFWFAuemlwLnRlc3QoZSk7XG4gICAgfSxcbiAgICBpc1Bob25lOiBmdW5jdGlvbiBpc1Bob25lKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLlJFR0VYUC5waG9uZS50ZXN0KGUpO1xuICAgIH0sXG4gICAgaXNQYXNzd29yZDogZnVuY3Rpb24gaXNQYXNzd29yZChlKSB7XG4gICAgICByZXR1cm4gdGhpcy5SRUdFWFAucGFzc3dvcmQudGVzdChlKTtcbiAgICB9LFxuICAgIGlzRW1wdHk6IGZ1bmN0aW9uIGlzRW1wdHkoZSkge1xuICAgICAgdmFyIHQgPSBlO1xuICAgICAgcmV0dXJuIGUudHJpbSAmJiAodCA9IGUudHJpbSgpKSwgIXQ7XG4gICAgfSxcbiAgICBjaGVja0xlbmd0aE1heDogZnVuY3Rpb24gY2hlY2tMZW5ndGhNYXgoZSwgdCkge1xuICAgICAgcmV0dXJuIGUubGVuZ3RoIDw9IHQ7XG4gICAgfSxcbiAgICBjaGVja0xlbmd0aE1pbjogZnVuY3Rpb24gY2hlY2tMZW5ndGhNaW4oZSwgdCkge1xuICAgICAgcmV0dXJuIGUubGVuZ3RoID49IHQ7XG4gICAgfSxcbiAgICBjaGVja1N0cmVuZ3RoUGFzczogZnVuY3Rpb24gY2hlY2tTdHJlbmd0aFBhc3MoZSkge1xuICAgICAgcmV0dXJuIHRoaXMuUkVHRVhQLnN0cmVuZ3RoUGFzcy50ZXN0KGUpO1xuICAgIH0sXG4gICAgZ2V0RWxlbWVudHM6IGZ1bmN0aW9uIGdldEVsZW1lbnRzKCkge1xuICAgICAgdmFyIGUgPSB0aGlzLFxuICAgICAgICAgIHQgPSB0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCJbZGF0YS12YWxpZGF0ZS1maWVsZF1cIik7XG4gICAgICB0aGlzLmVsZW1lbnRzID0gW107XG5cbiAgICAgIGZvciAodmFyIGkgPSBmdW5jdGlvbiBpKF9pLCByKSB7XG4gICAgICAgIHZhciBuID0gdFtfaV0sXG4gICAgICAgICAgICBvID0gbi5nZXRBdHRyaWJ1dGUoXCJkYXRhLXZhbGlkYXRlLWZpZWxkXCIpLFxuICAgICAgICAgICAgcyA9IG4udmFsdWUsXG4gICAgICAgICAgICBhID0gITEsXG4gICAgICAgICAgICBsID0gW107XG5cbiAgICAgICAgaWYgKFwiY2hlY2tib3hcIiA9PT0gbi50eXBlICYmIChzID0gbi5jaGVja2VkIHx8IFwiXCIsIG4uYWRkRXZlbnRMaXN0ZW5lcihcImNoYW5nZVwiLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgIHZhciBpID0gdC50YXJnZXQsXG4gICAgICAgICAgICAgIHIgPSB7XG4gICAgICAgICAgICBuYW1lOiBpLmdldEF0dHJpYnV0ZShcImRhdGEtdmFsaWRhdGUtZmllbGRcIiksXG4gICAgICAgICAgICB2YWx1ZTogaS5jaGVja2VkXG4gICAgICAgICAgfTtcbiAgICAgICAgICBkZWxldGUgZS5yZXN1bHRbci5uYW1lXSwgZS52YWxpZGF0ZUl0ZW0oe1xuICAgICAgICAgICAgbmFtZTogci5uYW1lLFxuICAgICAgICAgICAgdmFsdWU6IHIudmFsdWUsXG4gICAgICAgICAgICBncm91cDogW11cbiAgICAgICAgICB9KSwgZS5yZW5kZXJFcnJvcnMoKTtcbiAgICAgICAgfSkpLCBcInJhZGlvXCIgPT09IG4udHlwZSkge1xuICAgICAgICAgIHZhciB1ID0gZS5lbGVtZW50cy5maWx0ZXIoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIGlmIChlLm5hbWUgPT09IG8pIHJldHVybiBlO1xuICAgICAgICAgIH0pWzBdO1xuICAgICAgICAgIHUgPyAodS5ncm91cC5wdXNoKG4uY2hlY2tlZCksIGEgPSAhMCkgOiBsLnB1c2gobi5jaGVja2VkKSwgbi5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIGZ1bmN0aW9uICh0KSB7XG4gICAgICAgICAgICB2YXIgaSA9IHQudGFyZ2V0LFxuICAgICAgICAgICAgICAgIHIgPSB7XG4gICAgICAgICAgICAgIG5hbWU6IGkuZ2V0QXR0cmlidXRlKFwiZGF0YS12YWxpZGF0ZS1maWVsZFwiKSxcbiAgICAgICAgICAgICAgdmFsdWU6IGkuY2hlY2tlZFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGRlbGV0ZSBlLnJlc3VsdFtyLm5hbWVdLCBlLnZhbGlkYXRlSXRlbSh7XG4gICAgICAgICAgICAgIG5hbWU6IHIubmFtZSxcbiAgICAgICAgICAgICAgdmFsdWU6IHIudmFsdWUsXG4gICAgICAgICAgICAgIGdyb3VwOiBbXVxuICAgICAgICAgICAgfSksIGUucmVuZGVyRXJyb3JzKCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBlLnNldHRlckV2ZW50TGlzdGVuZXIobiwgXCJrZXl1cFwiLCBlLmhhbmRsZXJLZXl1cCwgXCJhZGRcIiksIGEgfHwgZS5lbGVtZW50cy5wdXNoKHtcbiAgICAgICAgICBuYW1lOiBvLFxuICAgICAgICAgIHZhbHVlOiBzLFxuICAgICAgICAgIGdyb3VwOiBsXG4gICAgICAgIH0pO1xuICAgICAgfSwgciA9IDAsIG4gPSB0Lmxlbmd0aDsgciA8IG47ICsrcikge1xuICAgICAgICBpKHIsIG4pO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnZhbGlkYXRlRWxlbWVudHMoKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlUmVxdWlyZWQ6IGZ1bmN0aW9uIHZhbGlkYXRlUmVxdWlyZWQoZSkge1xuICAgICAgcmV0dXJuICF0aGlzLmlzRW1wdHkoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUVtYWlsOiBmdW5jdGlvbiB2YWxpZGF0ZUVtYWlsKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzRW1haWwoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZVBob25lOiBmdW5jdGlvbiB2YWxpZGF0ZVBob25lKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzUGhvbmUoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZU1pbkxlbmd0aDogZnVuY3Rpb24gdmFsaWRhdGVNaW5MZW5ndGgoZSwgdCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tMZW5ndGhNaW4oZSwgdCk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZU1heExlbmd0aDogZnVuY3Rpb24gdmFsaWRhdGVNYXhMZW5ndGgoZSwgdCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tMZW5ndGhNYXgoZSwgdCk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZVN0cmVuZ3RoUGFzczogZnVuY3Rpb24gdmFsaWRhdGVTdHJlbmd0aFBhc3MoZSkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tTdHJlbmd0aFBhc3MoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZVBhc3N3b3JkOiBmdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKGUpIHtcbiAgICAgIHJldHVybiB0aGlzLmlzUGFzc3dvcmQoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZVppcDogZnVuY3Rpb24gdmFsaWRhdGVaaXAoZSkge1xuICAgICAgcmV0dXJuIHRoaXMuaXNaaXAoZSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZVJlbW90ZTogZnVuY3Rpb24gdmFsaWRhdGVSZW1vdGUoZSkge1xuICAgICAgdmFyIHQgPSBlLnZhbHVlLFxuICAgICAgICAgIGkgPSBlLm5hbWUsXG4gICAgICAgICAgciA9IGUudXJsLFxuICAgICAgICAgIG4gPSBlLnN1Y2Nlc3NBbnN3ZXIsXG4gICAgICAgICAgbyA9IGUuc2VuZFBhcmFtLFxuICAgICAgICAgIHMgPSBlLm1ldGhvZDtcbiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoZSkge1xuICAgICAgICBoKHtcbiAgICAgICAgICB1cmw6IHIsXG4gICAgICAgICAgbWV0aG9kOiBzLFxuICAgICAgICAgIGRhdGE6IF9kZWZpbmVQcm9wZXJ0eSh7fSwgbywgdCksXG4gICAgICAgICAgYXN5bmM6ICEwLFxuICAgICAgICAgIGNhbGxiYWNrOiBmdW5jdGlvbiBjYWxsYmFjayh0KSB7XG4gICAgICAgICAgICB0LnRvTG93ZXJDYXNlKCkgPT09IG4udG9Mb3dlckNhc2UoKSAmJiBlKFwib2tcIiksIGUoe1xuICAgICAgICAgICAgICB0eXBlOiBcImluY29ycmVjdFwiLFxuICAgICAgICAgICAgICBuYW1lOiBpXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9LFxuICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiBlcnJvcigpIHtcbiAgICAgICAgICAgIGUoe1xuICAgICAgICAgICAgICB0eXBlOiBcImVycm9yXCIsXG4gICAgICAgICAgICAgIG5hbWU6IGlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGdlbmVyYXRlTWVzc2FnZTogZnVuY3Rpb24gZ2VuZXJhdGVNZXNzYWdlKGUsIHQsIGkpIHtcbiAgICAgIHZhciByID0gdGhpcy5tZXNzYWdlcyB8fCB0aGlzLmRlZmF1bHRNZXNzYWdlcyxcbiAgICAgICAgICBuID0gclt0XSAmJiByW3RdW2VdIHx8IHRoaXMubWVzc2FnZXMgJiYgXCJzdHJpbmdcIiA9PSB0eXBlb2YgdGhpcy5tZXNzYWdlc1t0XSAmJiByW3RdIHx8IHRoaXMuZGVmYXVsdE1lc3NhZ2VzW2VdIHx8IHRoaXMuREVGQVVMVF9SRU1PVEVfRVJST1I7XG4gICAgICBpICYmIChuID0gbi5yZXBsYWNlKFwiOnZhbHVlXCIsIGkudG9TdHJpbmcoKSkpLCB0aGlzLnJlc3VsdFt0XSA9IHtcbiAgICAgICAgbWVzc2FnZTogblxuICAgICAgfTtcbiAgICB9LFxuICAgIHZhbGlkYXRlRWxlbWVudHM6IGZ1bmN0aW9uIHZhbGlkYXRlRWxlbWVudHMoKSB7XG4gICAgICB2YXIgZSA9IHRoaXM7XG4gICAgICByZXR1cm4gdGhpcy5sb2NrRm9ybSgpLCB0aGlzLmVsZW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgZS52YWxpZGF0ZUl0ZW0oe1xuICAgICAgICAgIG5hbWU6IHQubmFtZSxcbiAgICAgICAgICB2YWx1ZTogdC52YWx1ZSxcbiAgICAgICAgICBncm91cDogdC5ncm91cFxuICAgICAgICB9KTtcbiAgICAgIH0pLCB0aGlzLnByb21pc2VzUmVtb3RlLmxlbmd0aCA/IHZvaWQgUHJvbWlzZS5hbGwodGhpcy5wcm9taXNlc1JlbW90ZSkudGhlbihmdW5jdGlvbiAodCkge1xuICAgICAgICB0LmZvckVhY2goZnVuY3Rpb24gKHQpIHtcbiAgICAgICAgICByZXR1cm4gXCJva1wiID09PSB0ID8gdm9pZCBlLnJlbmRlckVycm9ycygpIDogKFwiZXJyb3JcIiA9PT0gdC50eXBlICYmIGFsZXJ0KFwiU2VydmVyIGVycm9yIG9jY3VyZWQuIFBsZWFzZSB0cnkgbGF0ZXIuXCIpLCBlLmdlbmVyYXRlTWVzc2FnZShsLCB0Lm5hbWUpLCB2b2lkIGUucmVuZGVyRXJyb3JzKCkpO1xuICAgICAgICB9KTtcbiAgICAgIH0pIDogdm9pZCB0aGlzLnJlbmRlckVycm9ycygpO1xuICAgIH0sXG4gICAgdmFsaWRhdGVJdGVtOiBmdW5jdGlvbiB2YWxpZGF0ZUl0ZW0oZSkge1xuICAgICAgdmFyIGMgPSB0aGlzLFxuICAgICAgICAgIGggPSBlLm5hbWUsXG4gICAgICAgICAgZiA9IGUuZ3JvdXAsXG4gICAgICAgICAgbSA9IGUudmFsdWUsXG4gICAgICAgICAgdiA9IGUuaXNLZXl1cENoYW5nZSxcbiAgICAgICAgICBwID0gdGhpcy5ydWxlc1toXSB8fCB0aGlzLmRlZmF1bHRSdWxlc1toXSB8fCAhMTtcbiAgICAgIGlmIChwKSBmb3IgKHZhciBnIGluIHApIHtcbiAgICAgICAgdmFyIHkgPSBwW2ddO1xuICAgICAgICBpZiAoZyAhPT0gdCAmJiBnICE9PSBkICYmIFwiXCIgPT0gbSkgcmV0dXJuO1xuXG4gICAgICAgIHN3aXRjaCAoZykge1xuICAgICAgICAgIGNhc2UgZDpcbiAgICAgICAgICAgIGlmIChcImZ1bmN0aW9uXCIgIT0gdHlwZW9mIHkpIGJyZWFrO1xuICAgICAgICAgICAgaWYgKHkoaCwgbSkpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy5nZW5lcmF0ZU1lc3NhZ2UoZCwgaCwgeSk7XG5cbiAgICAgICAgICBjYXNlIHQ6XG4gICAgICAgICAgICBpZiAoIXkpIGJyZWFrO1xuXG4gICAgICAgICAgICBpZiAoZi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgdmFyIGIgPSAhMTtcbiAgICAgICAgICAgICAgaWYgKGYuZm9yRWFjaChmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIGMudmFsaWRhdGVSZXF1aXJlZChlKSAmJiAoYiA9ICEwKTtcbiAgICAgICAgICAgICAgfSksIGIpIGJyZWFrO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnZhbGlkYXRlUmVxdWlyZWQobSkpIGJyZWFrO1xuXG4gICAgICAgICAgICByZXR1cm4gdm9pZCB0aGlzLmdlbmVyYXRlTWVzc2FnZSh0LCBoKTtcblxuICAgICAgICAgIGNhc2UgaTpcbiAgICAgICAgICAgIGlmICgheSkgYnJlYWs7XG4gICAgICAgICAgICBpZiAodGhpcy52YWxpZGF0ZUVtYWlsKG0pKSBicmVhaztcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMuZ2VuZXJhdGVNZXNzYWdlKGksIGgpO1xuXG4gICAgICAgICAgY2FzZSByOlxuICAgICAgICAgICAgaWYgKCF5KSBicmVhaztcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlTWluTGVuZ3RoKG0sIHkpKSBicmVhaztcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMuZ2VuZXJhdGVNZXNzYWdlKHIsIGgsIHkpO1xuXG4gICAgICAgICAgY2FzZSBuOlxuICAgICAgICAgICAgaWYgKCF5KSBicmVhaztcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlTWF4TGVuZ3RoKG0sIHkpKSBicmVhaztcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMuZ2VuZXJhdGVNZXNzYWdlKG4sIGgsIHkpO1xuXG4gICAgICAgICAgY2FzZSBhOlxuICAgICAgICAgICAgaWYgKCF5KSBicmVhaztcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlUGhvbmUobSkpIGJyZWFrO1xuICAgICAgICAgICAgcmV0dXJuIHZvaWQgdGhpcy5nZW5lcmF0ZU1lc3NhZ2UoYSwgaCk7XG5cbiAgICAgICAgICBjYXNlIG86XG4gICAgICAgICAgICBpZiAoIXkpIGJyZWFrO1xuICAgICAgICAgICAgaWYgKHRoaXMudmFsaWRhdGVQYXNzd29yZChtKSkgYnJlYWs7XG4gICAgICAgICAgICByZXR1cm4gdm9pZCB0aGlzLmdlbmVyYXRlTWVzc2FnZShvLCBoKTtcblxuICAgICAgICAgIGNhc2UgdTpcbiAgICAgICAgICAgIGlmICgheSB8fCBcIm9iamVjdFwiICE9PSAoXCJ1bmRlZmluZWRcIiA9PSB0eXBlb2YgeSA/IFwidW5kZWZpbmVkXCIgOiBfdHlwZW9mKHkpKSkgYnJlYWs7XG4gICAgICAgICAgICBpZiAoeVtcImRlZmF1bHRcIl0gJiYgdGhpcy52YWxpZGF0ZVN0cmVuZ3RoUGFzcyhtKSkgYnJlYWs7XG5cbiAgICAgICAgICAgIGlmICh5LmN1c3RvbSkge1xuICAgICAgICAgICAgICB2YXIgRSA9IHZvaWQgMDtcblxuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIEUgPSBuZXcgUmVnRXhwKHkuY3VzdG9tKTtcbiAgICAgICAgICAgICAgfSBjYXRjaCAodykge1xuICAgICAgICAgICAgICAgIEUgPSB0aGlzLlJFR0VYUC5zdHJlbmd0aFBhc3MsIGNvbnNvbGUuZXJyb3IoXCJDdXN0b20gcmVnZXhwIGZvciBzdHJlbmd0aCBydWxlIGlzIG5vdCB2YWxpZC4gRGVmYXVsdCByZWdleHAgd2FzIHVzZWQuXCIpO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgaWYgKEUudGVzdChtKSkgYnJlYWs7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMuZ2VuZXJhdGVNZXNzYWdlKHUsIGgpO1xuXG4gICAgICAgICAgY2FzZSBzOlxuICAgICAgICAgICAgaWYgKCF5KSBicmVhaztcbiAgICAgICAgICAgIGlmICh0aGlzLnZhbGlkYXRlWmlwKG0pKSBicmVhaztcbiAgICAgICAgICAgIHJldHVybiB2b2lkIHRoaXMuZ2VuZXJhdGVNZXNzYWdlKHMsIGgpO1xuXG4gICAgICAgICAgY2FzZSBsOlxuICAgICAgICAgICAgaWYgKHYpIGJyZWFrO1xuICAgICAgICAgICAgaWYgKCF5KSBicmVhaztcbiAgICAgICAgICAgIHZhciBrID0geS51cmwsXG4gICAgICAgICAgICAgICAgXyA9IHkuc3VjY2Vzc0Fuc3dlcixcbiAgICAgICAgICAgICAgICBQID0geS5tZXRob2QsXG4gICAgICAgICAgICAgICAgUiA9IHkuc2VuZFBhcmFtLFxuICAgICAgICAgICAgICAgIFMgPSB0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W2RhdGEtdmFsaWRhdGUtZmllbGQ9XCInICsgaCArICdcIl0nKTtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnNldHRlckV2ZW50TGlzdGVuZXIoUywgXCJrZXl1cFwiLCB0aGlzLmhhbmRsZXJLZXl1cCwgXCJyZW1vdmVcIiksIHZvaWQgdGhpcy5wcm9taXNlc1JlbW90ZS5wdXNoKHRoaXMudmFsaWRhdGVSZW1vdGUoe1xuICAgICAgICAgICAgICBuYW1lOiBoLFxuICAgICAgICAgICAgICB2YWx1ZTogbSxcbiAgICAgICAgICAgICAgdXJsOiBrLFxuICAgICAgICAgICAgICBtZXRob2Q6IFAsXG4gICAgICAgICAgICAgIHNlbmRQYXJhbTogUixcbiAgICAgICAgICAgICAgc3VjY2Vzc0Fuc3dlcjogX1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBjbGVhckVycm9yczogZnVuY3Rpb24gY2xlYXJFcnJvcnMoKSB7XG4gICAgICBmb3IgKHZhciBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5qcy12YWxpZGF0ZS1lcnJvci1sYWJlbFwiKSwgdCA9IDAsIGkgPSBlLmxlbmd0aDsgdCA8IGk7ICsrdCkge1xuICAgICAgICBlW3RdLnJlbW92ZSgpO1xuICAgICAgfVxuXG4gICAgICBlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5qcy12YWxpZGF0ZS1lcnJvci1maWVsZFwiKTtcblxuICAgICAgZm9yICh2YXIgciA9IDAsIG4gPSBlLmxlbmd0aDsgciA8IG47ICsrcikge1xuICAgICAgICBlW3JdLmNsYXNzTGlzdC5yZW1vdmUoXCJqcy12YWxpZGF0ZS1lcnJvci1maWVsZFwiKSwgZVtyXS5zdHlsZS5ib3JkZXIgPSBcIlwiLCBlW3JdLnN0eWxlLmNvbG9yID0gXCJcIjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHJlbmRlckVycm9yczogZnVuY3Rpb24gcmVuZGVyRXJyb3JzKCkge1xuICAgICAgdmFyIGUgPSB0aGlzO1xuICAgICAgaWYgKHRoaXMuY2xlYXJFcnJvcnMoKSwgdGhpcy51bmxvY2tGb3JtKCksIHRoaXMuaXNWYWxpZGF0aW9uU3VjY2VzcyA9ICExLCAwID09PSBPYmplY3Qua2V5cyh0aGlzLnJlc3VsdCkubGVuZ3RoKSByZXR1cm4gdm9pZCAodGhpcy5pc1ZhbGlkYXRpb25TdWNjZXNzID0gITApO1xuXG4gICAgICBmb3IgKHZhciB0IGluIHRoaXMucmVzdWx0KSB7XG4gICAgICAgIHZhciBpID0gdGhpcy5yZXN1bHRbdF0ubWVzc2FnZSxcbiAgICAgICAgICAgIHIgPSB0aGlzLiRmb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoJ1tkYXRhLXZhbGlkYXRlLWZpZWxkPVwiJyArIHQgKyAnXCJdJyksXG4gICAgICAgICAgICBuID0gcltyLmxlbmd0aCAtIDFdLFxuICAgICAgICAgICAgbyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cbiAgICAgICAgaWYgKG8uaW5uZXJIVE1MID0gaSwgby5jbGFzc05hbWUgPSBcImpzLXZhbGlkYXRlLWVycm9yLWxhYmVsXCIsIG8uc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJjb2xvcjogXCIgKyB0aGlzLmNvbG9yV3JvbmcpLCBuLnN0eWxlLmJvcmRlciA9IFwiMXB4IHNvbGlkIFwiICsgdGhpcy5jb2xvcldyb25nLCBuLnN0eWxlLmNvbG9yID0gXCJcIiArIHRoaXMuY29sb3JXcm9uZywgbi5jbGFzc0xpc3QuYWRkKFwianMtdmFsaWRhdGUtZXJyb3ItZmllbGRcIiksIFwiY2hlY2tib3hcIiA9PT0gbi50eXBlIHx8IFwicmFkaW9cIiA9PT0gbi50eXBlKSB7XG4gICAgICAgICAgdmFyIHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdsYWJlbFtmb3I9XCInICsgbi5nZXRBdHRyaWJ1dGUoXCJpZFwiKSArICdcIl0nKTtcbiAgICAgICAgICBcImxhYmVsXCIgPT09IG4ucGFyZW50Tm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCkgPyBuLnBhcmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobywgbnVsbCkgOiBzID8gcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShvLCBzLm5leHRTaWJsaW5nKSA6IG4ucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUobywgbi5uZXh0U2libGluZyk7XG4gICAgICAgIH0gZWxzZSBuLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKG8sIG4ubmV4dFNpYmxpbmcpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLnRvb2x0aXBTZWxlY3RvcldyYXAubGVuZ3RoICYmICh0aGlzLnN0YXRlLnRvb2x0aXBzVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgZS5oaWRlVG9vbHRpcHMoKTtcbiAgICAgIH0sIHRoaXMudG9vbHRpcEZhZGVPdXRUaW1lKSk7XG4gICAgfSxcbiAgICBoaWRlVG9vbHRpcHM6IGZ1bmN0aW9uIGhpZGVUb29sdGlwcygpIHtcbiAgICAgIHZhciBlID0gdGhpcyxcbiAgICAgICAgICB0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5qcy12YWxpZGF0ZS1lcnJvci1sYWJlbFwiKTtcbiAgICAgIHQuZm9yRWFjaChmdW5jdGlvbiAodCkge1xuICAgICAgICB0LmNsYXNzTGlzdC5hZGQoZS50b29sdGlwRmFkZU91dENsYXNzKTtcbiAgICAgIH0pLCB0aGlzLnN0YXRlLnRvb2x0aXBzVGltZXIgPSBudWxsO1xuICAgIH0sXG4gICAgbG9ja0Zvcm06IGZ1bmN0aW9uIGxvY2tGb3JtKCkge1xuICAgICAgZm9yICh2YXIgZSA9IHRoaXMuJGZvcm0ucXVlcnlTZWxlY3RvckFsbChcImlucHV0LCB0ZXh0YXJlYSwgYnV0dG9uLCBzZWxlY3RcIiksIHQgPSAwLCBpID0gZS5sZW5ndGg7IHQgPCBpOyArK3QpIHtcbiAgICAgICAgZVt0XS5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCBcImRpc2FibGVkXCIpLCBlW3RdLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIm5vbmVcIiwgZVt0XS5zdHlsZS53ZWJpdEZpbHRlciA9IFwiZ3JheXNjYWxlKDEwMCUpXCIsIGVbdF0uc3R5bGUuZmlsdGVyID0gXCJncmF5c2NhbGUoMTAwJSlcIjtcbiAgICAgIH1cbiAgICB9LFxuICAgIHVubG9ja0Zvcm06IGZ1bmN0aW9uIHVubG9ja0Zvcm0oKSB7XG4gICAgICBmb3IgKHZhciBlID0gdGhpcy4kZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXQsIHRleHRhcmVhLCBidXR0b24sIHNlbGVjdFwiKSwgdCA9IDAsIGkgPSBlLmxlbmd0aDsgdCA8IGk7ICsrdCkge1xuICAgICAgICBlW3RdLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpLCBlW3RdLnN0eWxlLnBvaW50ZXJFdmVudHMgPSBcIlwiLCBlW3RdLnN0eWxlLndlYml0RmlsdGVyID0gXCJcIiwgZVt0XS5zdHlsZS5maWx0ZXIgPSBcIlwiO1xuICAgICAgfVxuICAgIH1cbiAgfSwgZS5KdXN0VmFsaWRhdGUgPSBmO1xufSh3aW5kb3cpOyJdfQ==
